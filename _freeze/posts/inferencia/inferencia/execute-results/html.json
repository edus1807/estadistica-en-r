{
  "hash": "640a5d41b60cb2f77c410f3b0736e35a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Inferencia\"\ndescription: \n  Esperanza de vida e Índice de Desarrollo Humano  \nauthor: \"Eduardo Aragón\"\ndate: \"2026-01-16\"\ncategories: [Inferencia, ANOVA, Tukey, Kruskal-Wallis,Mann-Whitney,ggplot2]\nimage: \"inferencia.jpg\"\n---\n\nA continuación se presenta una actividad de inferencia sobre un conjunto de datos, los cuales se encuentran depurados y listos para usar desde mi directorio de Github, aunque podremos usarlos directamente desde la consola de R, como veremos más adelante.\n\nLos datos con los que vamos a trabajar han sido obtenidos del Instituto Vasco de Estadística-Eustat y tratan sobre el Índice de Desarrollo Humano (IDH) para 193 países, pudiendo ver el formato original en el siguiente enlace: [EUSTAT](https://www.eustat.eus/elementos/ele0013500/ti_indice-de-desarrollo-humano-por-indicadores-segun-paises-2019/tbl0013566_c.html)\n\nRespecto a la base de datos disponible en Eustat, nuestro archivo contiene una variable más relacionada con el nivel de desarrollo humano en lugar del propio índice. Eustat presenta en sus datos los países ordenados en función de si tienen un IDH muy alto, alto, medio y bajo. A partir de esta clasificación, se ha creado una variable cualitativa ordinal que representa a los países en función de dichas categorías.\n\nPodemos trabajar con estos datos de la siguiente manera, además de ver las variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndatos<-read.table(\"https://raw.githubusercontent.com/edus1807/Archivos_Quarto/refs/heads/main/renta_paises.txt\",header = T,sep=\";\")\nnames(datos)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"País\"                          \"IDH\"                          \n[3] \"Esperanza_de_vida\"             \"Años_esperados_de_escolaridad\"\n[5] \"Años_promedio_escolaridad\"     \"Renta_nacional_bruta\"         \n[7] \"Desarrollo_humano\"            \n```\n\n\n:::\n\n```{.r .cell-code}\nattach(datos)\n```\n:::\n\n\nEl nombre de las variables es bastante claro respecto a lo que representa cada una de ellas, indicando solo que la variable `Desarrollo_humano` es la que ha sido creada por nosotros. También podemos ver como se encuentra organizado el propio fichero y los niveles que tiene la variable creada, mediante el siguiente código:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(datos)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       País   IDH Esperanza_de_vida Años_esperados_de_escolaridad\n1  Islandia 0.972            82.691                      18.85059\n2   Noruega 0.970            83.308                      18.79285\n3     Suiza 0.970            83.954                      16.66753\n4 Dinamarca 0.962            81.933                      18.70401\n5  Alemania 0.959            81.378                      17.30922\n6    Suecia 0.959            83.262                      18.99147\n  Años_promedio_escolaridad Renta_nacional_bruta Desarrollo_humano\n1                  13.90893             69116.94          MUY ALTO\n2                  13.11796            112710.02          MUY ALTO\n3                  13.94912             81948.90          MUY ALTO\n4                  13.02732             76007.86          MUY ALTO\n5                  14.29637             64053.22          MUY ALTO\n6                  12.74033             66102.09          MUY ALTO\n```\n\n\n:::\n\n```{.r .cell-code}\nlevels(as.factor(Desarrollo_humano))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"ALTO\"     \"BAJO\"     \"MEDIO\"    \"MUY ALTO\"\n```\n\n\n:::\n:::\n\n\nA pesar de tener tantas variables, en este post solo nos centraremos en dos ellas, en la citada anteriormente `Desarrollo_humano` y en `Esperanza_de_vida`, puesto que nuestro objetivo será comprobar si la esperanza de vida puede considerarse igual en países con un distinto IDH. Para ello lo lógico sería pensar en un ANOVA, pues se trata de un caso de inferencia con más de dos poblaciones.\n\nPor tanto, la variable asociada a la esperanza de vida será nuestra variable dependiente, mientras que el factor `Desarrollo_humano` es la variable que define los grupos.\n\n# Análisis gráfico\n\nAntes de realizar la inferencia en si misma, podría ser útil ver como se comportan los datos en las cuatro categorías mediante un *box-plot*.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\nggplot(datos, aes(x = Desarrollo_humano, y = Esperanza_de_vida, fill = Desarrollo_humano)) + \n  stat_boxplot(geom = \"errorbar\",\n               width = 0.25) + \n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](inferencia_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nPodemos ver, antes de aplicar las técnicas que veremos más adelante, que sí parecen existir diferencias en la esperanza de vida en función del nivel de desarrollo humano. Concretamente vemos que aquellos países que tienen un IDH muy alto tienen más esperanza de vida que el resto, siguiendo un orden bastante descendiente en la esperanza cada vez que el IDH reduce su categoría. También se aprecia un valor atípico tanto para el desarrollo alto como medio.\n\n# ANOVA\n\nUna vez analizado el *box-plot*, es el momento de comprobar que se verifiquen las hipótesis básicas de este tipo de modelos.\n\nLo primero sería comprobar la independencia de las observaciones. En este caso vamos a asumir que los datos son independientes al tratarse de unidades nacionales distintas, sin entrar en debate de si un país depende de las características de sus vecinos, puesto se trata de un simple ejemplo.\n\nLa independencia de las observaciones se traduce a su vez en que los datos son aleatorios. Dicha aleatoriedad se podría comprobar mediante un test de rachas, pero en este caso no se considera pertinente. Los datos se encuentran ordenados en función de su IDH, por lo que seguro que dicho test va a detectar un patrón no aleatorio, rechazando así la aleatoriedad, lo cual no es un reflejo de la naturaleza de nuestros datos.\n\nPasamos a estudiar la homocedasticidad o igualdad de varianzas, puesto que para que se pueda usar el ANOVA la varianza en cada uno de los grupos debe ser significativamente igual. Para comprobarlo podemos plantear el siguiente contraste de hipótesis: $$\n\\begin{cases}\nH_0: \\sigma^2_\\text{Muy Alto}=\\sigma^2_\\text{Alto}=\\sigma^2_\\text{Medio}=\\sigma^2_\\text{Bajo} \\\\\nH_1: \\sigma^2_\\text{Muy Alto}\\neq\\sigma^2_\\text{Alto}\\neq\\sigma^2_\\text{Medio}\\neq\\sigma^2_\\text{Bajo}\n\\end{cases}\n$$ Este contraste puede ser resuelto mediante el test de Levene, siendo la función que permite su uso `leveneTest`, la cual se encuentra dentro de la librería `car`. Para poder usarla es necesario previamente realizar el modelo ANOVA mediante `aov`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova<-aov(Esperanza_de_vida ~ Desarrollo_humano, data = datos)\nrequire(car)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: car\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: carData\n```\n\n\n:::\n\n```{.r .cell-code}\nleveneTest(anova,center=mean)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in leveneTest.default(y = y, group = group, ...): group coerced to\nfactor.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLevene's Test for Homogeneity of Variance (center = mean)\n       Df F value Pr(>F)\ngroup   3  0.2346 0.8722\n      189               \n```\n\n\n:::\n:::\n\n\nObtenemos que el p-valor=0.8722 es mayor que un nivel de significación $\\alpha$=0.05, por lo que no tenemos evidencias estadísticas para rechazar la hipótesis nula anterior. Por tanto, podemos considerar las varianzas iguales con una significación del 5%.\n\nPor último, nos queda verificar si se cumple el supuesto de normalidad, donde los datos de cada grupo deben seguir de manera aproximada dicha distribución. Esto se puede comprobar de manera analítica mediante el test de Shapiro-Wilks o Kolmogorov-Smirnov (con la corrección de Lilliefors pues se trata de normalidad) o de manera visual con algún gráfico como un QQ-plot.\n\nEl uso de estos test suele medirse en función del tamaño de la muestra, siendo recomendado el uso de Shapiro-Wilks con tamaños menores de 50 unidades y K-S-Lilliefors en caso contrario. Los tamaños de cada nivel son:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nby(datos$Esperanza_de_vida,datos$Desarrollo_humano,length)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ndatos$Desarrollo_humano: ALTO\n[1] 50\n------------------------------------------------------------ \ndatos$Desarrollo_humano: BAJO\n[1] 26\n------------------------------------------------------------ \ndatos$Desarrollo_humano: MEDIO\n[1] 43\n------------------------------------------------------------ \ndatos$Desarrollo_humano: MUY ALTO\n[1] 74\n```\n\n\n:::\n:::\n\n\nIgualmente por comodidad podemos usar ambos en cada nivel y comparar resultados.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"nortest\")\nby(datos$Esperanza_de_vida,datos$Desarrollo_humano,lillie.test)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ndatos$Desarrollo_humano: ALTO\n\n\tLilliefors (Kolmogorov-Smirnov) normality test\n\ndata:  dd[x, ]\nD = 0.07324, p-value = 0.7218\n\n------------------------------------------------------------ \ndatos$Desarrollo_humano: BAJO\n\n\tLilliefors (Kolmogorov-Smirnov) normality test\n\ndata:  dd[x, ]\nD = 0.12845, p-value = 0.3286\n\n------------------------------------------------------------ \ndatos$Desarrollo_humano: MEDIO\n\n\tLilliefors (Kolmogorov-Smirnov) normality test\n\ndata:  dd[x, ]\nD = 0.070556, p-value = 0.8532\n\n------------------------------------------------------------ \ndatos$Desarrollo_humano: MUY ALTO\n\n\tLilliefors (Kolmogorov-Smirnov) normality test\n\ndata:  dd[x, ]\nD = 0.14025, p-value = 0.001012\n```\n\n\n:::\n\n```{.r .cell-code}\nby(datos$Esperanza_de_vida,datos$Desarrollo_humano,shapiro.test)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ndatos$Desarrollo_humano: ALTO\n\n\tShapiro-Wilk normality test\n\ndata:  dd[x, ]\nW = 0.97673, p-value = 0.4236\n\n------------------------------------------------------------ \ndatos$Desarrollo_humano: BAJO\n\n\tShapiro-Wilk normality test\n\ndata:  dd[x, ]\nW = 0.96422, p-value = 0.4812\n\n------------------------------------------------------------ \ndatos$Desarrollo_humano: MEDIO\n\n\tShapiro-Wilk normality test\n\ndata:  dd[x, ]\nW = 0.96394, p-value = 0.193\n\n------------------------------------------------------------ \ndatos$Desarrollo_humano: MUY ALTO\n\n\tShapiro-Wilk normality test\n\ndata:  dd[x, ]\nW = 0.94967, p-value = 0.005151\n```\n\n\n:::\n:::\n\n\nVemos que con ambos test, el p-valor asociado al nivel de IDH muy alto es menor que un nivel de significación $\\alpha$=0.05, por lo que tendríamos evidencias estadísticas para rechazar la normalidad en ese grupo. Lo vemos visualmente también:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(datos, aes(sample = Esperanza_de_vida)) +\n  stat_qq() +\n  stat_qq_line() +\n  facet_wrap(~Desarrollo_humano) +\n  labs(title = \"Gráfico Q-Q de Esperanza de vida por Desarrollo humano\")\n```\n\n::: {.cell-output-display}\n![](inferencia_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nVemos que en `MUY ALTO`, a partir del valor 0 del eje de abscisas los valores se alejan de la diagonal teórica formando una especie de curva sobre ella. Esto es claramente un indicio de falta de normalidad en dicho nivel como pudimos comprobar anteriormente.\n\nAnte esta situación se pueden valorar dos posibles opciones. Una es continuar empleando el ANOVA pues, aunque la normalidad no se verifica en uno de los niveles del factor, es una prueba bastante robusta a la falta de la misma cuando el tamaño de la muestra es grande (`MUY ALTO` tenía 74 países) y además, se verifica la homocedasticidad.\n\nSin embargo, si somos más rigurosos otra opción sería el uso de un enfoque no paramétrico, empleando el test de Kruskal-Wallis pues uno de los supuestos no se verifica.\n\nEn consecuencia, se aplicarán ambos procedimientos (ANOVA y Kruskal–Wallis) con el objetivo de comprobar la robustez de los resultados, observándose que las conclusiones obtenidas son consistentes entre ambos enfoques.\n\nSe plantea el contraste de hipótesis de igualdad de medias para el ANOVA y se muestra su salida en R:\n\n$$\n  \\begin{cases}\nH_0: \\mu_\\text{Muy Alto}=\\mu_\\text{Alto}=\\mu_\\text{Medio}=\\mu_\\text{Bajo}\\\\\nH_1: \\mu_\\text{Muy Alto}\\neq\\mu_\\text{Alto}\\neq\\mu_\\text{Medio}\\neq\\mu_\\text{Bajo}\n\\end{cases}\n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                   Df Sum Sq Mean Sq F value Pr(>F)    \nDesarrollo_humano   3   7096  2365.5   161.8 <2e-16 ***\nResiduals         189   2764    14.6                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\nObtenemos que el p-valor es menor que 0.05, por lo que tendríamos evidencias estadísticas para rechazar que las medias sean iguales. En ese caso habría que comprobar entre que niveles existen esas diferencias aplicando un test de comparaciones múltiples como Tukey.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTukeyHSD(anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = Esperanza_de_vida ~ Desarrollo_humano, data = datos)\n\n$Desarrollo_humano\n                    diff        lwr       upr    p adj\nBAJO-ALTO      -9.733709 -12.130267 -7.337151 0.00e+00\nMEDIO-ALTO     -5.520277  -7.581738 -3.458816 0.00e+00\nMUY ALTO-ALTO   6.700925   4.886400  8.515449 0.00e+00\nMEDIO-BAJO      4.213432   1.751044  6.675820 9.14e-05\nMUY ALTO-BAJO  16.434634  14.174937 18.694332 0.00e+00\nMUY ALTO-MEDIO 12.221202  10.320580 14.121824 0.00e+00\n```\n\n\n:::\n:::\n\n\nEn todas las comparaciones se obtiene un p-valor significativo, pues este es menor a cualquier nivel de significación arbitrario. Esto se traduce en que todos los niveles son significativamente distintos entre sí. Por poner un ejemplo, podemos decir que los países con IDH muy alto presentan 6.7 años más de esperanza de vida que aquellos con IDH alto, mientras que con el resto de resultados podríamos decir que a medida que aumenta el IDH se produce un aumento de la esperanza de vida.\n\n# Kruskal-Wallis\n\nComo se indicó anteriormente, puesto que la normalidad de uno de los niveles no se cumplía, una opción sería analizar las diferencias mediante un enfoque no paramétrico, empleando en este caso el test de Kruskal-Wallis. Planteamos el contraste en función de las medianas: $$\n  \\begin{cases}\nH_0: Med(\\text{Muy alto})= Med(\\text{Alto})=Med(\\text{Medio})= Med(\\text{Bajo}) \\\\\nH_1:  Med(\\text{Muy alto})\\neq Med(\\text{Alto})\\neq Med(\\text{Medio})\\neq Med(\\text{Bajo})\n\\end{cases}\n$$\n\nPara resolverlo aplicamos el siguiente código:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkruskal.test(Esperanza_de_vida ~ Desarrollo_humano, data = datos)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  Esperanza_de_vida by Desarrollo_humano\nKruskal-Wallis chi-squared = 141.39, df = 3, p-value < 2.2e-16\n```\n\n\n:::\n:::\n\n\nObtenemos que el p-valor es menor que 0.05, por lo que tendríamos evidencias estadísticas para rechazar que las medianas sean iguales. En ese caso habría que comprobar entre que niveles existen esas diferencias aplicando un test como Mann-Whitney con la corrección de Bonferroni.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npairwise.wilcox.test(Esperanza_de_vida,Desarrollo_humano,p.adjust.method = \"bonferroni\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPairwise comparisons using Wilcoxon rank sum test with continuity correction \n\ndata:  Esperanza_de_vida and Desarrollo_humano \n\n         ALTO    BAJO    MEDIO  \nBAJO     1.6e-10 -       -      \nMEDIO    2.5e-07 0.00061 -      \nMUY ALTO 5.2e-13 2.5e-13 < 2e-16\n\nP value adjustment method: bonferroni \n```\n\n\n:::\n:::\n\n\nVemos que todos los p-valores son menores que 0.05, por lo que podemos decir que existen diferencias significativas entre todos los niveles del IDH en función de la esperanza de vida.\n\n# Conclusiones\n\nPor tanto, independientemente del enfoque, tomado obtenemos que existen diferencias significativas entre los niveles del Índice de Desarrollo Humano en función de la esperanza de vida, siendo esta cada vez mayor a medida que aumenta el propio IDH.\n",
    "supporting": [
      "inferencia_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}